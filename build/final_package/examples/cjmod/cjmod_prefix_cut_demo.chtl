// CJMODå‰ç½®æˆªå–æ‰«ææ³•ä¸“é—¨æ¼”ç¤º
// å±•ç¤ºå‰ç½®æˆªå–æ³•çš„å¼ºå¤§èƒ½åŠ›
// ä¸¥æ ¼æŒ‰ç…§å®Œå–„é€‰æ‹©å™¨è‡ªåŠ¨åŒ–ä¸å¼•ç”¨è§„åˆ™.iniå®ç°

[Import] @CJmod from "prefix_cut_scanner"

[Configuration]
{
    CJMOD_PREFIX_CUT_SCAN = true;
    CJMOD_CUT_PRECISION = high;
    ENABLE_CONTEXT_DEDUCTION = true;
}

html
{
    head
    {
        title
        {
            text
            {
                CJMODå‰ç½®æˆªå–æ‰«ææ³•æ¼”ç¤º
            }
        }
    }
    
    body
    {
        div
        {
            id: prefix-cut-demo;
            class: cut-scanner-demo;
            
            text
            {
                âœ‚ï¸ å‰ç½®æˆªå–æ‰«ææ³•å¼ºå¤§åŠŸèƒ½å±•ç¤º
            }
            
            script
            {
                // å‰ç½®æˆªå–æ‰«ææ³•å·¥ä½œåŸç†æ¼”ç¤ºï¼š
                // 1. æ‰«æåˆ°å…³é”®å­—åï¼Œä¼šå›å¤´æˆªå–å…³é”®å­—å‰é¢éƒ¨åˆ†çš„å‚æ•°
                // 2. é¿å…é”™è¯¯åœ°å‘é€ç»™ç¼–è¯‘å™¨ï¼Œä»¥æ­¤è·å–å®Œæ•´ç‰‡æ®µ
                // 3. ç¡®ä¿å‚æ•°çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§
                
                // ç¤ºä¾‹1: å‡½æ•°å‚æ•°å‰ç½®æˆªå–
                // å½“æ‰«æåˆ° 'then' å…³é”®å­—æ—¶ï¼Œå›å¤´æˆªå–å‰é¢çš„å‚æ•°
                asyncFunction(param1, param2, param3) then handleResult;
                // å‰ç½®æˆªå–: "asyncFunction(param1, param2, param3)"
                // å®Œæ•´ç‰‡æ®µ: "then handleResult"
                
                processData(input, options, callback) then validateResult then formatOutput;
                // å‰ç½®æˆªå–: "processData(input, options, callback)"
                // å®Œæ•´ç‰‡æ®µ: "then validateResult then formatOutput"
                
                // ç¤ºä¾‹2: é€‰æ‹©å™¨å‚æ•°å‰ç½®æˆªå–
                // å½“æ‰«æåˆ° '->' æ—¶ï¼Œå›å¤´æˆªå–é€‰æ‹©å™¨å‚æ•°
                document.querySelector('.target') -> click;
                // å‰ç½®æˆªå–: "document.querySelector('.target')"
                // å®Œæ•´ç‰‡æ®µ: "-> click"
                
                {{.advanced-selector}} -> hover;
                // å‰ç½®æˆªå–: "{{.advanced-selector}}"
                // å®Œæ•´ç‰‡æ®µ: "-> hover"
                
                // ç¤ºä¾‹3: æ¡ä»¶è¯­å¥å‰ç½®æˆªå–
                // å½“æ‰«æåˆ° 'if' å…³é”®å­—æ—¶ï¼Œå›å¤´æˆªå–æ¡ä»¶å‚æ•°
                (x > 0 && y < 100) if condition then action;
                // å‰ç½®æˆªå–: "(x > 0 && y < 100)"
                // å®Œæ•´ç‰‡æ®µ: "if condition then action"
                
                // ç¤ºä¾‹4: å¤æ‚è¡¨è¾¾å¼å‰ç½®æˆªå–
                Math.pow(base, exponent) + offset * multiplier when ready then execute;
                // å‰ç½®æˆªå–: "Math.pow(base, exponent) + offset * multiplier"
                // å®Œæ•´ç‰‡æ®µ: "when ready then execute"
                
                {{.cut-scanner-demo}} -> click {
                    console.log('âœ‚ï¸ å‰ç½®æˆªå–æ‰«ææ³•æ¼”ç¤ºè§¦å‘');
                    
                    // æ¼”ç¤ºæˆªå–è¿‡ç¨‹
                    console.log('ğŸ” æ‰«æåˆ°å…³é”®å­—: "then"');
                    console.log('â†©ï¸  å›å¤´æˆªå–å‰ç½®å‚æ•°');
                    console.log('âœ‚ï¸  æˆªå–: "asyncFunction(param1, param2)"');
                    console.log('ğŸ“¦ å®Œæ•´ç‰‡æ®µ: "then handleResult"');
                    console.log('âœ… é¿å…é”™è¯¯å‘é€ç»™ç¼–è¯‘å™¨');
                    
                    // ä½¿ç”¨CJMOD APIæ¼”ç¤º
                    vir cutPattern = Syntax.analyze('$ then $');
                    vir cutResult = CJMODScanner.scan(cutPattern, 'then');
                    
                    console.log('å‰ç½®æˆªå–ç»“æœ:', cutResult);
                }
                
                // ç¤ºä¾‹5: åµŒå¥—ç»“æ„å‰ç½®æˆªå–
                complexObject.method(param1, {
                    nested: value1,
                    deep: {
                        property: value2
                    }
                }) when complete then processResult;
                
                // å‰ç½®æˆªå–ä¼šæ­£ç¡®å¤„ç†åµŒå¥—ç»“æ„
                
                // ç¤ºä¾‹6: é“¾å¼è°ƒç”¨å‰ç½®æˆªå–
                dataProcessor
                    .input(rawData)
                    .validate(rules)
                    .transform(mapper)
                    .output(format) 
                    when finished then notifyUser;
                
                {{#prefix-cut-demo}} -> mouseenter {
                    console.log('ğŸ¯ å‰ç½®æˆªå–ï¼šé¼ æ ‡è¿›å…¥äº‹ä»¶');
                    
                    // æ¼”ç¤ºå‰ç½®æˆªå–çš„ç²¾ç¡®æ€§
                    vir cutScanner = createPrefixCutScanner({
                        keywords: ['then', 'when', 'if', '->'],
                        precision: 'high'
                    });
                    
                    vir cutResults = cutScanner.scanAll(document.body.textContent);
                    
                    console.log('å‰ç½®æˆªå–ç»“æœ:', cutResults);
                }
                
                // ç¤ºä¾‹7: å‚æ•°å®Œæ•´æ€§ä¿è¯
                function demonstrateParameterIntegrity() {
                    // å‰ç½®æˆªå–ç¡®ä¿å‚æ•°ä¸ä¼šè¢«é”™è¯¯åˆ†å‰²
                    
                    let functionCall = complexFunction(
                        param1,
                        param2,
                        {
                            nested: true,
                            complex: [1, 2, 3]
                        }
                    ) then processResult;
                    
                    // å‰ç½®æˆªå–ä¼šæ­£ç¡®è¯†åˆ«å®Œæ•´çš„å‡½æ•°è°ƒç”¨å‚æ•°
                    // ä¸ä¼šåœ¨åµŒå¥—ç»“æ„ä¸­é—´æ–­å¼€
                    
                    return functionCall;
                }
            }
            
            style
            {
                background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
                padding: 40px;
                border-radius: 20px;
                box-shadow: 0 15px 50px rgba(255, 154, 158, 0.4);
                color: #333;
                text-align: center;
                position: relative;
                
                .cut-scanner-demo {
                    font-size: 24px;
                    font-weight: bold;
                    margin-bottom: 20px;
                    color: #d63384;
                }
                
                &:before {
                    content: 'âœ‚ï¸';
                    position: absolute;
                    top: 20px;
                    right: 20px;
                    font-size: 40px;
                    opacity: 0.4;
                    animation: cut-animation 2s infinite;
                }
                
                @keyframes cut-animation {
                    0%, 100% { transform: rotate(0deg); }
                    25% { transform: rotate(-10deg); }
                    75% { transform: rotate(10deg); }
                }
                
                & {
                    transition: all 0.4s ease;
                }
                
                &:hover {
                    transform: translateY(-10px);
                    box-shadow: 0 25px 70px rgba(255, 154, 158, 0.6);
                    background: linear-gradient(45deg, #ff6b9d 0%, #f093fb 50%, #f093fb 100%);
                }
            }
        }
        
        div
        {
            class: cutting-visualization;
            
            text
            {
                å‰ç½®æˆªå–è¿‡ç¨‹å¯è§†åŒ–
            }
            
            script
            {
                function visualizeCuttingProcess() {
                    console.log('âœ‚ï¸ å‰ç½®æˆªå–æ‰«ææ³•å¯åŠ¨');
                    console.log('ğŸ“ æºä»£ç : "asyncFunction(a, b, c) then handleResult"');
                    
                    console.log('\nğŸ” æ‰«æè¿‡ç¨‹:');
                    console.log('1. å¼€å§‹æ‰«æ...');
                    console.log('2. å‘ç°å…³é”®å­— "then" ä½ç½®: 25');
                    console.log('3. â†©ï¸  å›å¤´æˆªå–å‰ç½®å‚æ•°');
                    console.log('4. æˆªå–èŒƒå›´: 0 â†’ 25');
                    console.log('5. å‰ç½®å‚æ•°: "asyncFunction(a, b, c)"');
                    console.log('6. ğŸ“¦ è·å–å®Œæ•´ç‰‡æ®µ: "then handleResult"');
                    console.log('7. âœ… é¿å…é”™è¯¯å‘é€ç»™ç¼–è¯‘å™¨');
                    
                    console.log('\nğŸ“Š æˆªå–ç»“æœ:');
                    console.log('   å‰ç½®å‚æ•°ç‰‡æ®µ: "asyncFunction(a, b, c)"');
                    console.log('   å®Œæ•´ç‰‡æ®µ: "then handleResult"');
                    console.log('   âœ… å‚æ•°å®Œæ•´æ€§: ä¿è¯');
                    console.log('   âœ… ç¼–è¯‘å™¨å®‰å…¨: ä¿è¯');
                }
                
                {{.cutting-visualization}} -> click {
                    visualizeCuttingProcess();
                }
                
                // ä½¿ç”¨CJMOD APIæ¼”ç¤ºå‰ç½®æˆªå–
                vir cutPattern = Syntax.analyze('$ then $');
                vir cutScanner = CJMODScanner.createPrefixCutScanner();
                
                vir cutResult = cutScanner.scan(cutPattern, 'then');
                console.log('CJMODå‰ç½®æˆªå–ç»“æœ:', cutResult);
            }
            
            style
            {
                background: #fff3cd;
                border: 3px dashed #ffc107;
                border-radius: 15px;
                padding: 30px;
                margin: 30px 0;
                cursor: pointer;
                
                .cutting-visualization {
                    color: #856404;
                    font-size: 20px;
                    font-weight: bold;
                }
                
                &:hover {
                    background: #fff8e1;
                    border-color: #ffb300;
                    transform: scale(1.03);
                    box-shadow: 0 8px 25px rgba(255, 193, 7, 0.3);
                }
            }
        }
    }
}