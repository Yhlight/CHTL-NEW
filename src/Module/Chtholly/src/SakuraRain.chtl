;; 珂朵莉樱花雨自定义组件
;; 基于珂朵莉角色设计的樱花飘落特效

[Custom] @SakuraRain
{
    div
    {
        class: chtholly-sakura-container;
        
        style
        {
            .chtholly-sakura-container
            {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1000;
                overflow: hidden;
            }
            
            .sakura-petal
            {
                position: absolute;
                width: 12px;
                height: 12px;
                background: radial-gradient(circle, #FFB6C1 0%, #FF69B4 50%, #FF1493 100%);
                border-radius: 50% 0 50% 0;
                opacity: 0.8;
                animation: sakuraFall linear infinite;
                transform-origin: center;
            }
            
            @keyframes sakuraFall
            {
                0% {
                    transform: translateY(-100px) rotate(0deg);
                    opacity: 0;
                }
                10% {
                    opacity: 0.8;
                }
                90% {
                    opacity: 0.8;
                }
                100% {
                    transform: translateY(calc(100vh + 100px)) rotate(360deg);
                    opacity: 0;
                }
            }
            
            .sakura-petal:nth-child(odd)
            {
                animation-duration: 8s;
                animation-delay: 0s;
            }
            
            .sakura-petal:nth-child(even)
            {
                animation-duration: 12s;
                animation-delay: 2s;
            }
            
            .sakura-petal:nth-child(3n)
            {
                animation-duration: 10s;
                animation-delay: 1s;
                background: radial-gradient(circle, #FFC0CB 0%, #FF91A4 50%, #FF69B4 100%);
            }
        }
        
        script
        {
            // 珂朵莉樱花雨效果
            const container = {{.chtholly-sakura-container}};
            const petalCount = @PetalCount || 50;
            const fallDuration = @FallDuration || 10000;
            
            function createSakuraPetal() {
                const petal = document.createElement('div');
                petal.className = 'sakura-petal';
                
                // 随机位置和大小
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDuration = (Math.random() * 6 + 6) + 's';
                petal.style.animationDelay = Math.random() * 2 + 's';
                
                // 随机大小
                const size = Math.random() * 8 + 8;
                petal.style.width = size + 'px';
                petal.style.height = size + 'px';
                
                container.appendChild(petal);
                
                // 花瓣落下后移除
                setTimeout(() => {
                    if (petal.parentElement) {
                        petal.remove();
                    }
                }, fallDuration);
            }
            
            // 启动樱花雨
            function startSakuraRain() {
                console.log('🌸 珂朵莉的樱花雨开始飘落...');
                
                // 初始创建花瓣
                for (let i = 0; i < petalCount; i++) {
                    setTimeout(() => {
                        createSakuraPetal();
                    }, i * 200);
                }
                
                // 持续创建新花瓣
                setInterval(() => {
                    createSakuraPetal();
                }, 800);
            }
            
            // 自动启动
            if (@AutoStart !== false) {
                startSakuraRain();
            }
            
            // 导出控制接口
            window.ChthollyEffects = window.ChthollyEffects || {};
            window.ChthollyEffects.SakuraRain = {
                start: startSakuraRain,
                stop: () => {
                    container.innerHTML = '';
                    console.log('🌸 樱花雨已停止');
                }
            };
        }
    }
}