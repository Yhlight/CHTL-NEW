// CJMOD强大特征演示 - 严格按CJMOD文档

[Import] @CJmod from Chtholly

// printMylove功能演示
printMylove {
    target: "世界",
    message: "珂朵莉的爱意",
    mode: "ASCII",
    style: "romantic"
}

// iNeverAway功能演示
vir EternalGuardian = iNeverAway {
    Void<Promise>: function(target, duration) {
        console.log(`💝 永恒的承诺: 我将永远守护${target}`);
        return new Promise(resolve => {
            setTimeout(() => {
                console.log(`⭐ 守护时间: ${duration}ms 完成`);
                resolve(`守护${target}的承诺已实现`);
            }, duration);
        });
    },
    
    Void<Protect>: function(target, threat) {
        console.log(`🛡️ 保护${target}免受${threat}的伤害`);
        return {
            status: "protected",
            target: target,
            threat: threat,
            guardian: "珂朵莉"
        };
    },
    
    Void: {
        console.log("💫 永恒守护系统已激活");
    }
}

// util...then异步链式操作演示
util.fadeIn(document.querySelector('.chtholly-card'))
    .then(util.slideDown())
    .then(util.addSparkles())
    .then(() => {
        console.log('✨ 珂朵莉特效序列完成');
    });

// 增强选择器演示
listen {
    selector: {{.love-button}},
    event: "click",
    callback: function(event) {
        // 使用printMylove功能
        const result = printMylove {
            target: "你",
            message: "珂朵莉的祝福",
            mode: "Pixel"
        };
        
        console.log('💕 爱的表达结果:', result);
        
        // 触发永恒守护
        EternalGuardian.Promise("你", 3000).then(guardResult => {
            console.log('🌟 守护完成:', guardResult);
            alert('💝 珂朵莉的爱意和守护已传达给你！');
        });
    }
}

// 委托事件处理
delegate {
    parent: ".chtholly-container",
    target: ".interactive-element", 
    event: "mouseover",
    callback: function(event) {
        // 使用iNeverAway保护功能
        const protection = EternalGuardian.Protect(
            event.target.textContent,
            "恶意操作"
        );
        
        console.log('🛡️ 保护状态:', protection);
        
        // 添加保护特效
        event.target.style.border = '2px solid #4ecdc4';
        event.target.style.boxShadow = '0 0 10px rgba(78, 205, 196, 0.5)';
    }
}

// 动画系统演示
animate {
    target: ".chtholly-title",
    keyframes: {
        "0%": { opacity: 0, transform: "translateY(-30px)" },
        "50%": { opacity: 0.7, transform: "translateY(-10px)" },
        "100%": { opacity: 1, transform: "translateY(0)" }
    },
    duration: 1500,
    easing: "cubic-bezier(0.25, 0.46, 0.45, 0.94)"
}

// &-> 事件绑定操作符演示
document.querySelector('.special-element') &-> 'dblclick' &-> function(event) {
    console.log('💫 双击特殊事件触发');
    
    // 组合使用多个CJMOD功能
    const loveMessage = printMylove {
        target: "特别的人",
        message: "珂朵莉的特殊祝福",
        mode: "special"
    };
    
    const protection = EternalGuardian.Promise("特别的人", 5000);
    
    Promise.all([loveMessage, protection]).then(results => {
        console.log('🎊 组合功能执行完成:', results);
        event.target.innerHTML = '🌟 珂朵莉的祝福已完成';
    });
}

// -> 操作符演示
{{.chtholly-info}} -> textContent -> "珂朵莉·诺塔·塞尼欧里斯 - 世界上最幸福的女孩"
{{.chtholly-quote}} -> innerHTML -> `
    <blockquote>
        <p>"我想要成为世界上最幸福的女孩。"</p>
        <footer>— 珂朵莉·诺塔·塞尼欧里斯</footer>
    </blockquote>
`

// 模块导入演示（AMD风格）
module {
    name: "ChthollyFeatures",
    exports: {
        printMylove: printMylove,
        EternalGuardian: EternalGuardian,
        showLove: function(target) {
            return printMylove {
                target: target,
                message: "来自珂朵莉的爱",
                animation: "gentle"
            };
        }
    },
    dependencies: ["chtl::Chtholly"]
}