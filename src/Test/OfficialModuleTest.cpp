#include "../Module/ModuleLoader.h"
#include <iostream>

int main() {
    std::cout << "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" << std::endl;
    std::cout << "â•‘                        ðŸ›ï¸ CHTLå®˜æ–¹æ¨¡å—æµ‹è¯• ðŸ›ï¸                                            â•‘" << std::endl;
    std::cout << "â•‘                     ç‚æœµèŽ‰æ¨¡å—Â·ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—Â·æ ‡å‡†CMODç»“æž„                                â•‘" << std::endl;
    std::cout << "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" << std::endl;
    
    std::cout << "\nðŸŽ¯ å®˜æ–¹æ¨¡å—åŠ è½½æµ‹è¯•:" << std::endl;
    std::cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" << std::endl;
    
    try {
        // 1. åˆå§‹åŒ–å®˜æ–¹æ¨¡å—åŠ è½½å™¨
        std::cout << "\nðŸ—ï¸ æ­¥éª¤1: åˆå§‹åŒ–å®˜æ–¹æ¨¡å—åŠ è½½å™¨" << std::endl;
        
        CHTL::Module::OfficialModuleLoader loader;
        bool initSuccess = loader.Initialize("src/Module");
        
        std::cout << "  å®˜æ–¹æ¨¡å—åŠ è½½å™¨åˆå§‹åŒ–: " << (initSuccess ? "âœ… æˆåŠŸ" : "âŒ å¤±è´¥") << std::endl;
        
        if (!initSuccess) {
            std::cout << "  âŒ æ— æ³•ç»§ç»­æµ‹è¯•ï¼Œåˆå§‹åŒ–å¤±è´¥" << std::endl;
            return 1;
        }
        
        // 2. æ‰«æå¹¶åŠ è½½æ‰€æœ‰å®˜æ–¹æ¨¡å—
        std::cout << "\nðŸ“¦ æ­¥éª¤2: æ‰«æå¹¶åŠ è½½å®˜æ–¹æ¨¡å—" << std::endl;
        
        size_t loadedCount = loader.LoadAllOfficialModules();
        std::cout << "  æˆåŠŸåŠ è½½å®˜æ–¹æ¨¡å—æ•°é‡: " << loadedCount << " ä¸ª" << std::endl;
        
        auto officialModules = loader.GetOfficialModuleList();
        std::cout << "  å®˜æ–¹æ¨¡å—åˆ—è¡¨:" << std::endl;
        for (const auto& moduleName : officialModules) {
            std::cout << "    ðŸ“¦ " << moduleName << std::endl;
            
            // èŽ·å–æ¨¡å—è¯¦ç»†ä¿¡æ¯
            const auto* info = loader.GetModuleInfo(moduleName);
            if (info) {
                std::cout << "      ç‰ˆæœ¬: " << info->Version << std::endl;
                std::cout << "      æè¿°: " << info->Description << std::endl;
                std::cout << "      ä½œè€…: " << info->Author << std::endl;
            }
        }
        
        // 3. æµ‹è¯•ç‚æœµèŽ‰æ¨¡å—
        std::cout << "\nðŸ’– æ­¥éª¤3: ç‚æœµèŽ‰æ¨¡å—è¯¦ç»†æµ‹è¯•" << std::endl;
        
        bool hasChtholly = loader.IsOfficialModule("Chtholly");
        std::cout << "  ç‚æœµèŽ‰æ¨¡å—å­˜åœ¨: " << (hasChtholly ? "âœ… æ˜¯" : "âŒ å¦") << std::endl;
        
        if (hasChtholly) {
            const auto* chthollyInfo = loader.GetModuleInfo("Chtholly");
            if (chthollyInfo) {
                std::cout << "  ðŸŒŸ ç‚æœµèŽ‰æ¨¡å—ä¿¡æ¯:" << std::endl;
                std::cout << "    è§’è‰²: ç‚æœµèŽ‰Â·è¯ºå¡”Â·å¡žå°¼æ¬§é‡Œæ–¯" << std::endl;
                std::cout << "    ä½œå“: ã€Šæœ«æ—¥æ—¶åœ¨åšä»€ä¹ˆï¼Ÿæœ‰æ²¡æœ‰ç©ºï¼Ÿå¯ä¸å¯ä»¥æ¥æ‹¯æ•‘ï¼Ÿã€‹" << std::endl;
                std::cout << "    æè¿°: " << chthollyInfo->Description << std::endl;
                std::cout << "    ç‰ˆæœ¬: " << chthollyInfo->Version << std::endl;
                std::cout << "    è®¸å¯: " << chthollyInfo->License << std::endl;
                
                auto chthollyModule = loader.GetCMODManager()->FindModule("Chtholly");
                if (chthollyModule) {
                    const auto& exports = chthollyModule->GetExports();
                    std::cout << "  ðŸŽ¯ å¯¼å‡ºåŠŸèƒ½ (" << exports.size() << "ä¸ª):" << std::endl;
                    
                    for (const auto& exportItem : exports) {
                        std::cout << "    â€¢ " << exportItem.Name << " (" << exportItem.Type << ")" << std::endl;
                        std::cout << "      è·¯å¾„: " << exportItem.Path << std::endl;
                        std::cout << "      å®Œå…¨é™å®šå: " << exportItem.FullQualifiedName << std::endl;
                    }
                }
            }
        }
        
        // 4. æµ‹è¯•ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—
        std::cout << "\nðŸŒ¸ æ­¥éª¤4: ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—è¯¦ç»†æµ‹è¯•" << std::endl;
        
        bool hasYuigahama = loader.IsOfficialModule("Yuigahama");
        std::cout << "  ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—å­˜åœ¨: " << (hasYuigahama ? "âœ… æ˜¯" : "âŒ å¦") << std::endl;
        
        if (hasYuigahama) {
            const auto* yuigahamaInfo = loader.GetModuleInfo("Yuigahama");
            if (yuigahamaInfo) {
                std::cout << "  ðŸŒŸ ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—ä¿¡æ¯:" << std::endl;
                std::cout << "    è§’è‰²: ç”±æ¯”æ»¨ç»“è¡£" << std::endl;
                std::cout << "    ä½œå“: ã€Šæˆ‘çš„é’æ˜¥æ‹çˆ±ç‰©è¯­æžœç„¶æœ‰é—®é¢˜ã€‹" << std::endl;
                std::cout << "    æè¿°: " << yuigahamaInfo->Description << std::endl;
                std::cout << "    ç‰ˆæœ¬: " << yuigahamaInfo->Version << std::endl;
                std::cout << "    å£å¤´ç¦…: é›…å“ˆå–½ï½ž" << std::endl;
                
                auto yuigahamaModule = loader.GetCMODManager()->FindModule("Yuigahama");
                if (yuigahamaModule) {
                    const auto& exports = yuigahamaModule->GetExports();
                    std::cout << "  ðŸŽ¯ å¯¼å‡ºåŠŸèƒ½ (" << exports.size() << "ä¸ª):" << std::endl;
                    
                    for (const auto& exportItem : exports) {
                        std::cout << "    â€¢ " << exportItem.Name << " (" << exportItem.Type << ")" << std::endl;
                    }
                }
            }
        }
        
        // 5. ç”Ÿæˆå®Œæ•´æŠ¥å‘Š
        std::cout << "\nðŸ“‹ æ­¥éª¤5: ç”Ÿæˆå®Œæ•´å®˜æ–¹æ¨¡å—æŠ¥å‘Š" << std::endl;
        std::cout << loader.GenerateOfficialModuleReport() << std::endl;
        
    }
    catch (const std::exception& e) {
        std::cout << "  âœ— å®˜æ–¹æ¨¡å—æµ‹è¯•å¼‚å¸¸: " << e.what() << std::endl;
    }
    
    std::cout << "\nðŸŒŸ å®˜æ–¹æ¨¡å—ç‰¹è‰²æ€»ç»“:" << std::endl;
    std::cout << "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" << std::endl;
    std::cout << "â”‚                              ðŸ’– ç‚æœµèŽ‰æ¨¡å—                                                  â”‚" << std::endl;
    std::cout << "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤" << std::endl;
    std::cout << "â”‚ ðŸŒ¸ ç±»åž‹: CMOD + CJMOD æ··åˆæ¨¡å—                                                              â”‚" << std::endl;
    std::cout << "â”‚ ðŸ”¥ CMODåŠŸèƒ½: æ‰‹é£Žç´ã€å››å¶çª—ç›¸å†Œã€å¤‡å¿˜å½•ã€æš–è‰²ç¬”è®°ã€æ¨±èŠ±é›¨ã€é¼ æ ‡ç‰¹æ•ˆç­‰                    â”‚" << std::endl;
    std::cout << "â”‚ âš¡ CJMODåŠŸèƒ½: printMyloveã€iNeverAwayã€util...thenè¡¨è¾¾å¼                                  â”‚" << std::endl;
    std::cout << "â”‚ ðŸ’Ž ç‰¹è‰²: åŸºäºŽç‚æœµèŽ‰è§’è‰²è®¾è®¡ï¼Œä½“çŽ°æ¸©æŸ”å–„è‰¯ã€ä¿æŠ¤ä½¿å‘½çš„ç²¾ç¥ž                                 â”‚" << std::endl;
    std::cout << "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" << std::endl;
    
    std::cout << "\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" << std::endl;
    std::cout << "â”‚                              ðŸŒ¸ ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—                                              â”‚" << std::endl;
    std::cout << "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤" << std::endl;
    std::cout << "â”‚ ðŸŽ€ ç±»åž‹: çº¯CMODæ¨¡å—                                                                         â”‚" << std::endl;
    std::cout << "â”‚ ðŸŽµ CMODåŠŸèƒ½: éŸ³ä¹æ’­æ”¾å™¨ã€æ‰‹é£Žç´ã€å››å¶çª—ç›¸å†Œã€å¤‡å¿˜å½•ã€æš–è‰²ç¬”è®°ã€æ¨±èŠ±é›¨ã€é¼ æ ‡ç‰¹æ•ˆ          â”‚" << std::endl;
    std::cout << "â”‚ ðŸ’• ç‰¹è‰²: åŸºäºŽç”±æ¯”æ»¨ç»“è¡£è§’è‰²è®¾è®¡ï¼Œä½“çŽ°å¼€æœ—æ´»æ³¼ã€å–„äºŽç¤¾äº¤çš„ç‰¹è‰²                             â”‚" << std::endl;
    std::cout << "â”‚ ðŸ—£ï¸ å£å¤´ç¦…: é›…å“ˆå–½ï½ž                                                                        â”‚" << std::endl;
    std::cout << "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" << std::endl;
    
    std::cout << "\nðŸŽŠ æ¨¡å—è®¾è®¡ä¸¥æ ¼éµå¾ªæ–‡æ¡£è§„èŒƒ:" << std::endl;
    std::cout << "  âœ… æ ‡å‡†CMODç»“æž„: src/ + info/ ç›®å½•" << std::endl;
    std::cout << "  âœ… æ¨¡å—ä¿¡æ¯æ–‡ä»¶: module.info åŒ…å«å®Œæ•´ä¿¡æ¯" << std::endl;
    std::cout << "  âœ… å¯¼å‡ºè¡¨å®šä¹‰: æ˜Žç¡®çš„å¯¼å‡ºé¡¹å’Œå®Œå…¨é™å®šå" << std::endl;
    std::cout << "  âœ… æ··åˆæ¨¡å—æ”¯æŒ: ç‚æœµèŽ‰æ¨¡å—çš„CMOD+CJMODç»“æž„" << std::endl;
    std::cout << "  âœ… çº¯CMODæ¨¡å—: ç”±æ¯”æ»¨ç»“è¡£æ¨¡å—çš„æ ‡å‡†CMODç»“æž„" << std::endl;
    std::cout << "  âœ… è§’è‰²ç‰¹è‰²ä½“çŽ°: åŸºäºŽè§’è‰²è®¾è®¡çš„ç‹¬ç‰¹åŠŸèƒ½" << std::endl;
    
    std::cout << "\nðŸ† å®˜æ–¹æ¨¡å—æµ‹è¯•å®Œæˆï¼" << std::endl;
    std::cout << "ç‚æœµèŽ‰å’Œç”±æ¯”æ»¨ç»“è¡£çš„å®˜æ–¹æ¨¡å—å·²æŒ‰ç…§CHTLæ–‡æ¡£è§„èŒƒå®Œæ•´å®žçŽ°ã€‚" << std::endl;
    
    return 0;
}