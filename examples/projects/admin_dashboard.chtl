// ‰ºÅ‰∏öÁ∫ßÁÆ°ÁêÜÂêéÂè∞ - Â±ïÁ§∫ÊâÄÊúâCHTLËØ≠Ê≥ïÁâπÂæÅÁöÑÂ§ßÂûãÈ°πÁõÆ
[Import] @Chtl from Chtholly
[Import] @Chtl from Yuigahama

[Namespace] AdminDashboard::Components

[Configuration]
{
    DISABLE_STYLE_AUTO_ADD_CLASS = false;
    DISABLE_STYLE_AUTO_ADD_ID = false;
    DISABLE_SCRIPT_AUTO_ADD_CLASS = false;
    DISABLE_SCRIPT_AUTO_ADD_ID = false;
    ENABLE_CONTEXT_DEDUCTION = true;
    ADMIN_THEME = "professional";
    SIDEBAR_WIDTH = "280px";
    HEADER_HEIGHT = "60px";
}

[Template] @Style DashboardLayout
{
    display: grid;
    grid-template-areas: 
        "sidebar header header"
        "sidebar main main";
    grid-template-columns: SIDEBAR_WIDTH 1fr 1fr;
    grid-template-rows: HEADER_HEIGHT 1fr;
    height: 100vh;
    font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
}

[Template] @Style SidebarStyle
{
    grid-area: sidebar;
    background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
    color: white;
    overflow-y: auto;
}

[Template] @Style HeaderStyle
{
    grid-area: header;
    background: white;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

[Template] @Style MainContentStyle
{
    grid-area: main;
    background: #f8f9fa;
    padding: 30px;
    overflow-y: auto;
}

[Template] @Var DashboardColors
{
    primaryColor: "#3498db";
    secondaryColor: "#2c3e50";
    successColor: "#27ae60";
    warningColor: "#f39c12";
    dangerColor: "#e74c3c";
    lightBg: "#ecf0f1";
    darkText: "#2c3e50";
}

[Custom] @Style MetricCard
{
    @Style YuigahamaCard;
    // Áâπ‰æãÂåñÊìç‰Ωú
    delete border-left;
    background: white;
    border-radius: 8px;
    padding: 25px;
    text-align: center;
    transition: all 0.3s ease;
}

[Custom] @Style SuccessMetric
{
    @Style MetricCard;
    border-top: 4px solid DashboardColors(successColor);
}

[Custom] @Style WarningMetric
{
    @Style MetricCard;
    border-top: 4px solid DashboardColors(warningColor);
}

[Custom] @Style DangerMetric
{
    @Style MetricCard;
    border-top: 4px solid DashboardColors(dangerColor);
}

// Êó†ÂÄºÊ†∑ÂºèÁªÑ
[Custom] @Style TableReset
{
    border-collapse: collapse;
    width: 100%;
    margin: 0;
    padding: 0;
}

html
{
    head
    {
        title
        {
            CHTL‰ºÅ‰∏öÁ∫ßÁÆ°ÁêÜÂêéÂè∞
        }
        
        meta
        {
            charset: "UTF-8";
        }
        
        meta
        {
            name: "viewport";
            content: "width=device-width, initial-scale=1.0";
        }
        
        -- ËøôÊòØÁîüÊàêÂô®ËØÜÂà´ÁöÑÊ≥®ÈáäÔºå‰ºöÁîüÊàêHTMLÊ≥®Èáä
    }
    
    body
    {
        style
        {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        div
        {
            id: dashboard-app;
            
            style
            {
                @Style DashboardLayout;
            }
            
            // ‰æßËæπÊ†è
            aside
            {
                style
                {
                    @Style SidebarStyle;
                }
                
                div
                {
                    style
                    {
                        .sidebar-header
                        {
                            padding: 20px;
                            border-bottom: 1px solid rgba(255,255,255,0.1);
                            text-align: center;
                        }
                    }
                    
                    h2
                    {
                        style
                        {
                            margin: 0;
                            font-size: 1.2em;
                            color: ChthollyColors(primaryColor);
                        }
                        
                        text { üè¢ ÁÆ°ÁêÜÂêéÂè∞ }
                    }
                    
                    p
                    {
                        style
                        {
                            margin: 5px 0 0 0;
                            font-size: 0.9em;
                            opacity: 0.8;
                        }
                        
                        text { CHTLÈ©±Âä® }
                    }
                }
                
                nav
                {
                    style
                    {
                        .sidebar-nav
                        {
                            padding: 20px 0;
                        }
                    }
                    
                    ul
                    {
                        style
                        {
                            list-style: none;
                            margin: 0;
                            padding: 0;
                        }
                        
                        li
                        {
                            a
                            {
                                href: "#dashboard";
                                
                                style
                                {
                                    .nav-item
                                    {
                                        display: block;
                                        padding: 15px 30px;
                                        color: white;
                                        text-decoration: none;
                                        transition: all 0.3s ease;
                                        border-left: 3px solid transparent;
                                    }
                                    
                                    .nav-item:hover
                                    {
                                        background: rgba(255,255,255,0.1);
                                        border-left-color: DashboardColors(primaryColor);
                                    }
                                    
                                    .nav-item.active
                                    {
                                        background: rgba(52, 152, 219, 0.2);
                                        border-left-color: DashboardColors(primaryColor);
                                    }
                                }
                                
                                text { üìä ‰ª™Ë°®Êùø }
                            }
                        }
                        
                        li
                        {
                            a
                            {
                                href: "#users";
                                
                                style
                                {
                                    @Style nav-item;
                                }
                                
                                text { üë• Áî®Êà∑ÁÆ°ÁêÜ }
                            }
                        }
                        
                        li
                        {
                            a
                            {
                                href: "#modules";
                                
                                style
                                {
                                    @Style nav-item;
                                }
                                
                                text { üì¶ Ê®°ÂùóÁÆ°ÁêÜ }
                            }
                        }
                        
                        li
                        {
                            a
                            {
                                href: "#settings";
                                
                                style
                                {
                                    @Style nav-item;
                                }
                                
                                text { ‚öôÔ∏è Á≥ªÁªüËÆæÁΩÆ }
                            }
                        }
                    }
                }
            }
            
            // Â§¥ÈÉ®
            header
            {
                style
                {
                    @Style HeaderStyle;
                }
                
                div
                {
                    h1
                    {
                        style
                        {
                            margin: 0;
                            font-size: 1.5em;
                            color: DashboardColors(darkText);
                        }
                        
                        text { ‰ºÅ‰∏öÁ∫ßÁÆ°ÁêÜÂêéÂè∞ }
                    }
                }
                
                div
                {
                    style
                    {
                        .user-info
                        {
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        }
                    }
                    
                    span
                    {
                        text { ÁÆ°ÁêÜÂëòÔºöÁèÇÊúµËéâ }
                    }
                    
                    button
                    {
                        id: logout-btn;
                        
                        style
                        {
                            @Style ChthollyButton;
                            font-size: 0.9em;
                            padding: 8px 16px;
                        }
                        
                        text { ÈÄÄÂá∫ }
                    }
                }
            }
            
            // ‰∏ªÂÜÖÂÆπÂå∫Âüü
            main
            {
                style
                {
                    @Style MainContentStyle;
                }
                
                // ‰ª™Ë°®ÊùøÊ¶ÇËßà
                section
                {
                    id: dashboard-overview;
                    
                    h2
                    {
                        style
                        {
                            margin-bottom: 30px;
                            color: DashboardColors(darkText);
                        }
                        
                        text { üìà Êï∞ÊçÆÊ¶ÇËßà }
                    }
                    
                    div
                    {
                        style
                        {
                            .metrics-grid
                            {
                                display: grid;
                                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                                gap: 20px;
                                margin-bottom: 40px;
                            }
                        }
                        
                        div
                        {
                            style
                            {
                                @Style SuccessMetric;
                            }
                            
                            h3
                            {
                                style
                                {
                                    color: DashboardColors(successColor);
                                    margin: 0 0 10px 0;
                                }
                                
                                text { Âú®Á∫øÁî®Êà∑ }
                            }
                            
                            div
                            {
                                style
                                {
                                    font-size: 2.5em;
                                    font-weight: bold;
                                    color: DashboardColors(successColor);
                                }
                                
                                text { 1,234 }
                            }
                            
                            p
                            {
                                style
                                {
                                    margin: 10px 0 0 0;
                                    color: #666;
                                    font-size: 0.9em;
                                }
                                
                                text { ‚ÜóÔ∏è +12% ÊØîÊò®Â§© }
                            }
                        }
                        
                        div
                        {
                            style
                            {
                                @Style WarningMetric;
                            }
                            
                            h3
                            {
                                style
                                {
                                    color: DashboardColors(warningColor);
                                    margin: 0 0 10px 0;
                                }
                                
                                text { ÂæÖÂ§ÑÁêÜ‰ªªÂä° }
                            }
                            
                            div
                            {
                                style
                                {
                                    font-size: 2.5em;
                                    font-weight: bold;
                                    color: DashboardColors(warningColor);
                                }
                                
                                text { 56 }
                            }
                        }
                        
                        div
                        {
                            style
                            {
                                @Style DangerMetric;
                            }
                            
                            h3
                            {
                                style
                                {
                                    color: DashboardColors(dangerColor);
                                    margin: 0 0 10px 0;
                                }
                                
                                text { Á≥ªÁªüË≠¶Âëä }
                            }
                            
                            div
                            {
                                style
                                {
                                    font-size: 2.5em;
                                    font-weight: bold;
                                    color: DashboardColors(dangerColor);
                                }
                                
                                text { 3 }
                            }
                        }
                        
                        div
                        {
                            style
                            {
                                @Style MetricCard;
                                border-top: 4px solid DashboardColors(primaryColor);
                            }
                            
                            h3
                            {
                                style
                                {
                                    color: DashboardColors(primaryColor);
                                    margin: 0 0 10px 0;
                                }
                                
                                text { Ê®°ÂùóÊï∞Èáè }
                            }
                            
                            div
                            {
                                style
                                {
                                    font-size: 2.5em;
                                    font-weight: bold;
                                    color: DashboardColors(primaryColor);
                                }
                                
                                text { 2 }
                            }
                            
                            p
                            {
                                style
                                {
                                    margin: 10px 0 0 0;
                                    color: #666;
                                    font-size: 0.9em;
                                }
                                
                                text { ÁèÇÊúµËéâ + Áî±ÊØîÊª® }
                            }
                        }
                    }
                }
                
                // Êï∞ÊçÆË°®Ê†º
                section
                {
                    h2
                    {
                        style
                        {
                            margin-bottom: 20px;
                            color: DashboardColors(darkText);
                        }
                        
                        text { üìã Áî®Êà∑ÂàóË°® }
                    }
                    
                    div
                    {
                        style
                        {
                            @Style YuigahamaCard;
                        }
                        
                        table
                        {
                            style
                            {
                                @Style TableReset;
                            }
                            
                            thead
                            {
                                style
                                {
                                    background: DashboardColors(lightBg);
                                }
                                
                                tr
                                {
                                    th
                                    {
                                        style
                                        {
                                            padding: 15px;
                                            text-align: left;
                                            font-weight: 600;
                                            color: DashboardColors(darkText);
                                            border-bottom: 2px solid #dee2e6;
                                        }
                                        
                                        text { ID }
                                    }
                                    
                                    th
                                    {
                                        text { Áî®Êà∑Âêç }
                                    }
                                    
                                    th
                                    {
                                        text { ÈÇÆÁÆ± }
                                    }
                                    
                                    th
                                    {
                                        text { Áä∂ÊÄÅ }
                                    }
                                    
                                    th
                                    {
                                        text { Êìç‰Ωú }
                                    }
                                }
                            }
                            
                            tbody
                            {
                                tr
                                {
                                    class: user-row;
                                    
                                    style
                                    {
                                        &:hover
                                        {
                                            background: #f1f3f4;
                                        }
                                    }
                                    
                                    td
                                    {
                                        style
                                        {
                                            padding: 15px;
                                            border-bottom: 1px solid #dee2e6;
                                        }
                                        
                                        text { 001 }
                                    }
                                    
                                    td
                                    {
                                        text { ÁèÇÊúµËéâ }
                                    }
                                    
                                    td
                                    {
                                        text { chtholly@fairy.com }
                                    }
                                    
                                    td
                                    {
                                        span
                                        {
                                            style
                                            {
                                                .status-active
                                                {
                                                    background: DashboardColors(successColor);
                                                    color: white;
                                                    padding: 4px 8px;
                                                    border-radius: 12px;
                                                    font-size: 0.8em;
                                                }
                                            }
                                            
                                            text { Ê¥ªË∑É }
                                        }
                                    }
                                    
                                    td
                                    {
                                        button
                                        {
                                            class: edit-user-btn;
                                            
                                            style
                                            {
                                                @Style ChthollyButton;
                                                font-size: 0.8em;
                                                padding: 6px 12px;
                                                margin-right: 5px;
                                            }
                                            
                                            text { ÁºñËæë }
                                        }
                                        
                                        button
                                        {
                                            class: delete-user-btn;
                                            
                                            style
                                            {
                                                background: DashboardColors(dangerColor);
                                                color: white;
                                                border: none;
                                                padding: 6px 12px;
                                                border-radius: 4px;
                                                cursor: pointer;
                                                font-size: 0.8em;
                                            }
                                            
                                            text { Âà†Èô§ }
                                        }
                                    }
                                }
                                
                                tr
                                {
                                    class: user-row;
                                    
                                    td
                                    {
                                        text { 002 }
                                    }
                                    
                                    td
                                    {
                                        text { Áî±ÊØîÊª®ÁªìË°£ }
                                    }
                                    
                                    td
                                    {
                                        text { yuigahama@school.com }
                                    }
                                    
                                    td
                                    {
                                        span
                                        {
                                            style
                                            {
                                                .status-inactive
                                                {
                                                    background: DashboardColors(warningColor);
                                                    color: white;
                                                    padding: 4px 8px;
                                                    border-radius: 12px;
                                                    font-size: 0.8em;
                                                }
                                            }
                                            
                                            text { Á¶ªÁ∫ø }
                                        }
                                    }
                                    
                                    td
                                    {
                                        button
                                        {
                                            class: edit-user-btn;
                                            text { ÁºñËæë }
                                        }
                                        
                                        button
                                        {
                                            class: delete-user-btn;
                                            text { Âà†Èô§ }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                
                // Ê®°ÂùóÁä∂ÊÄÅÂ±ïÁ§∫
                section
                {
                    style
                    {
                        margin-top: 40px;
                    }
                    
                    h2
                    {
                        text { üì¶ Â∑≤ÂÆâË£ÖÊ®°Âùó }
                    }
                    
                    div
                    {
                        @Element FourLeafAlbum;
                        
                        style
                        {
                            width: 300px;
                            height: 300px;
                            margin: 20px auto;
                        }
                        
                        div
                        {
                            class: module-item;
                            
                            text { ÁèÇÊúµËéâÊ®°Âùó }
                        }
                        
                        div
                        {
                            class: module-item;
                            
                            text { Áî±ÊØîÊª®Ê®°Âùó }
                        }
                        
                        div
                        {
                            class: module-item;
                            
                            text { Á≥ªÁªüÊ†∏ÂøÉ }
                        }
                        
                        div
                        {
                            class: module-item;
                            
                            text { CJMODÊâ©Â±ï }
                        }
                    }
                }
            }
        }
        
        // ÂéüÂßãÂµåÂÖ•ÊºîÁ§∫
        origin
        {
            <!-- ËøôÊòØÂéüÂßãHTMLÊ≥®ÈáäÔºåÊºîÁ§∫originÂäüËÉΩ -->
            <script async src="https://example.com/analytics.js"></script>
        }
        
        // ÂÖ®Â±ÄÊ†∑Âºè
        style
        {
            .metrics-grid
            {
                animation: fadeInUp 0.6s ease-out;
            }
            
            @keyframes fadeInUp
            {
                from
                {
                    opacity: 0;
                    transform: translateY(30px);
                }
                
                to
                {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .module-item
            {
                background: rgba(255, 107, 107, 0.1);
                padding: 15px;
                border-radius: 8px;
                text-align: center;
                font-weight: bold;
                color: DashboardColors(darkText);
            }
        }
        
        // Â±ÄÈÉ®script - Â±ïÁ§∫ÊâÄÊúâCHTL JSÁâπÂæÅ
        script
        {
            console.log('üè¢ ‰ºÅ‰∏öÁ∫ßÁÆ°ÁêÜÂêéÂè∞Âä†ËΩΩÂÆåÊàê');
            console.log('üéØ ‰ΩøÁî®ÊâÄÊúâCHTLËØ≠Ê≥ïÁâπÂæÅ');
            
            // Â¢ûÂº∫ÈÄâÊã©Âô®ÊºîÁ§∫
            {{#logout-btn}}->addEventListener('click', () => {
                if (confirm('Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁÆ°ÁêÜÂêéÂè∞ÂêóÔºü')) {
                    alert('üëã ÂÜçËßÅÔºÅÊÑüË∞¢‰ΩøÁî®CHTLÁÆ°ÁêÜÂêéÂè∞');
                    console.log('üö™ Áî®Êà∑ÈÄÄÂá∫Á≥ªÁªü');
                }
            });
            
            // &->‰∫ã‰ª∂ÁªëÂÆöÊìç‰ΩúÁ¨¶
            {{.nav-item}} &-> click {
                // ÁßªÈô§ÊâÄÊúâactiveÁ±ª
                {{.nav-item}}->forEach(item => {
                    item.classList.remove('active');
                });
                
                // Ê∑ªÂä†activeÁ±ªÂà∞ÂΩìÂâçÈ°π
                this.classList.add('active');
                console.log('üß≠ ÂØºËà™ÂàáÊç¢:', this.textContent);
            }
            
            // listenÂ¢ûÂº∫ÁõëÂê¨Âô®
            {{.edit-user-btn}}->listen {
                click: function() {
                    const row = this.closest('.user-row');
                    const username = row.cells[1].textContent;
                    alert(`‚úèÔ∏è ÁºñËæëÁî®Êà∑: ${username}`);
                    console.log('‚úèÔ∏è ÁºñËæëÁî®Êà∑Êìç‰Ωú');
                },
                
                mouseenter: function() {
                    this.style.transform = 'scale(1.05)';
                },
                
                mouseleave: function() {
                    this.style.transform = 'scale(1)';
                }
            };
            
            // delegate‰∫ã‰ª∂ÂßîÊâò
            {{tbody}}->delegate {
                target: {{.delete-user-btn}},
                click: function(event) {
                    const row = event.target.closest('.user-row');
                    const username = row.cells[1].textContent;
                    
                    if (confirm(`‚ö†Ô∏è Á°ÆÂÆöË¶ÅÂà†Èô§Áî®Êà∑ ${username} ÂêóÔºü`)) {
                        console.log('üóëÔ∏è Âà†Èô§Áî®Êà∑:', username);
                        row.remove();
                        alert(`‚úÖ Áî®Êà∑ ${username} Â∑≤Âà†Èô§`);
                    }
                }
            };
            
            // animateÂä®ÁîªÁ≥ªÁªü
            const dashboardAnim = animate {
                target: {{.metrics-grid}},
                duration: 1000,
                easing: ease-out,
                
                begin: {
                    opacity: 0,
                    transform: 'translateY(50px)'
                },
                
                when: [
                    {
                        at: 0.3;
                        opacity: 0.3,
                        transform: 'translateY(30px)'
                    },
                    {
                        at: 0.7;
                        opacity: 0.8,
                        transform: 'translateY(10px)'
                    }
                ],
                
                end: {
                    opacity: 1,
                    transform: 'translateY(0)'
                },
                
                callback: function() {
                    console.log('üìä ‰ª™Ë°®ÊùøÂä®ÁîªÂÆåÊàê');
                }
            };
            
            // virËôöÂØπË±° - ÁÆ°ÁêÜÂêéÂè∞ÊéßÂà∂Âô®
            vir AdminController = listen {
                refreshData: function() {
                    console.log('üîÑ Âà∑Êñ∞Êï∞ÊçÆ');
                    // Ê®°ÊãüÊï∞ÊçÆÂà∑Êñ∞
                    {{.metrics-grid}}->style.opacity = '0.5';
                    setTimeout(() => {
                        {{.metrics-grid}}->style.opacity = '1';
                        console.log('‚úÖ Êï∞ÊçÆÂà∑Êñ∞ÂÆåÊàê');
                    }, 1000);
                },
                
                exportData: function() {
                    console.log('üì§ ÂØºÂá∫Êï∞ÊçÆ');
                    alert('üìä Êï∞ÊçÆÂØºÂá∫ÂäüËÉΩ\nÊ≠£Âú®ÁîüÊàêExcelÊä•Ë°®...');
                },
                
                systemStatus: {
                    online: true,
                    lastUpdate: Date.now()
                }
            };
            
            // È°µÈù¢ÂàùÂßãÂåñ
            document.addEventListener('DOMContentLoaded', function() {
                console.log('üìÑ ÁÆ°ÁêÜÂêéÂè∞È°µÈù¢ÂàùÂßãÂåñÂÆåÊàê');
                
                // ËÆæÁΩÆÈªòËÆ§Ê¥ªË∑ÉÂØºËà™
                {{.nav-item}}[0]->classList.add('active');
                
                // ÂÆöÊó∂Âà∑Êñ∞Êï∞ÊçÆ
                setInterval(() => {
                    AdminController->refreshData();
                }, 30000); // 30ÁßíÂà∑Êñ∞‰∏ÄÊ¨°
                
                // ÊòæÁ§∫Á≥ªÁªüÁä∂ÊÄÅ
                console.log('üñ•Ô∏è Á≥ªÁªüÁä∂ÊÄÅ:', AdminController->systemStatus);
            });
            
            // ÈîÆÁõòÂø´Êç∑ÈîÆ
            document.addEventListener('keydown', function(event) {
                if (event.ctrlKey && event.key === 'r') {
                    event.preventDefault();
                    AdminController->refreshData();
                }
                
                if (event.ctrlKey && event.key === 'e') {
                    event.preventDefault();
                    AdminController->exportData();
                }
            });
        }
    }
}